importScripts("./md5.js","./chars.js");var workerId,maxPassLength=void 0,passToCrack=void 0,interval=1e5,count=0,startTime=+new Date;function status(a){this.postMessage({cmd:"status",data:a,id:workerId})}function log(a){this.postMessage({cmd:"log",data:a,id:workerId})}function crack(a){status("processing");var s,t,r,e=a.hop,o=1,d=new ArrayBuffer(maxPassLength),i=new Uint8Array(d),n=i.subarray(maxPassLength-o);for(i[maxPassLength-1]=from+a.start;;){if(r=String.fromCharCode.apply(null,n),md5(r)==passToCrack)return void this.postMessage({cmd:"foundPassword",data:r,id:workerId});s=n[o-1],t=n[o-1]+=e,s<skip1_from&&t>=skip1_from?n[o-1]=skip1_to+(t-skip1_from):s<skip2_from&&t>=skip2_from&&(n[o-1]=skip2_to+(t-skip2_from));for(var m=o-1;0<=m;--m)if(n[m]>=to)if(n[m]=n[m]%to+from,0==m){if(o+=1,(n=i.subarray(maxPassLength-o))[0]=from,maxPassLength<o)return}else(t=n[m-1]+=1)==skip1_from&&(t=n[m-1]=skip1_to),t==skip2_from&&(t=n[m-1]=skip2_to);(count+=1)%interval==0&&(this.postMessage({cmd:"setRate",data:interval/((new Date-startTime)/1e3),id:workerId}),count=0,startTime=+new Date)}}this.addEventListener("message",function(a){switch(a.data.cmd){case"setWorkerId":workerId=a.data.data;break;case"setMaxPassLength":maxPassLength=a.data.data;break;case"setPassToCrack":passToCrack=a.data.data;break;case"performCrack":crack(a.data.data);break;default:this.postMessage({cmd:"log",data:"Worker doesn't understand command "+a.data.cmd})}});
